{"version":3,"file":"head-components.js","names":["IsHeadRenderContext","React","createContext","getValidHeadComponentReplacements","originalCreateElement","forceHeadRenderContext","useIsHeadRender","isHeadRenderFromContext","useContext","htmlOrBodyComponentFactory","TagName","HeadAwareComponent","props","isHeadRender","allProps","HTML_BODY_ORIGINAL_TAG_ATTRIBUTE_KEY","displayName","nodeComponentFactory","ITEM_PROP_WORKAROUND_KEY","propsWithWorkaround","ITEM_PROP_WORKAROUND_VALUE","Map","VALID_NODE_NAMES","map","nodeName","replacement"],"sources":["../../../head/components/head-components.js"],"sourcesContent":["import React from \"react\"\n\nimport {\n  HTML_BODY_ORIGINAL_TAG_ATTRIBUTE_KEY,\n  ITEM_PROP_WORKAROUND_KEY,\n  ITEM_PROP_WORKAROUND_VALUE,\n  VALID_NODE_NAMES,\n} from \"../constants\"\n\nexport const IsHeadRenderContext = React.createContext(false)\n\nexport function getValidHeadComponentReplacements(\n  originalCreateElement,\n  forceHeadRenderContext\n) {\n  function useIsHeadRender() {\n    if (forceHeadRenderContext) {\n      // for SSR we don't need to use React context, because head rendering is sync\n      // so forcing it is more performant\n      return true\n    }\n\n    // for Browser we use React Context\n    // note: technically this is breaking rules of hooks, because useContext is used\n    // not at the top of the hook after some conditional code did run,\n    // but this would only manifest if `forceHeadRenderContext` could change between rerenders,\n    // and because this is factory argument, it can't change\n    const isHeadRenderFromContext = React.useContext(IsHeadRenderContext)\n\n    return isHeadRenderFromContext\n  }\n\n  function htmlOrBodyComponentFactory(TagName) {\n    const HeadAwareComponent = props => {\n      // De-risk monkey patch by only applying it within a `Head()` render.\n      const isHeadRender = useIsHeadRender()\n      if (isHeadRender) {\n        const allProps = {\n          ...props,\n          [HTML_BODY_ORIGINAL_TAG_ATTRIBUTE_KEY]: TagName,\n        }\n        return originalCreateElement(`div`, allProps)\n      } else {\n        return originalCreateElement(TagName, props)\n      }\n    }\n    HeadAwareComponent.displayName = `React19HeadAPICompat${TagName}`\n    return HeadAwareComponent\n  }\n\n  function nodeComponentFactory(TagName) {\n    const HeadAwareComponent = props => {\n      // De-risk monkey patch by only applying it within a `Head()` render:\n      const isHeadRender = useIsHeadRender()\n      // only modify props if ITEM_PROP_WORKAROUND_KEY is not set in props\n      if (isHeadRender && !(ITEM_PROP_WORKAROUND_KEY in props)) {\n        const propsWithWorkaround = {\n          ...props,\n          [ITEM_PROP_WORKAROUND_KEY]: ITEM_PROP_WORKAROUND_VALUE,\n        }\n        return originalCreateElement(TagName, propsWithWorkaround)\n      }\n\n      return originalCreateElement(TagName, props)\n    }\n    HeadAwareComponent.displayName = `React19HeadAPICompat${TagName}`\n    return HeadAwareComponent\n  }\n\n  return new Map(\n    VALID_NODE_NAMES.map(nodeName => {\n      // for each of valid head nodes we will create replacement component\n      // that can check IsHeadRenderContext context (it is a new component,\n      // so this won't break rules of hooks) and apply workarounds for\n      // React 19 automatic handling of meta tags which is incompatible with\n      // Gatsby Head API\n\n      const replacement =\n        nodeName === `html` || nodeName === `body`\n          ? htmlOrBodyComponentFactory(nodeName)\n          : nodeComponentFactory(nodeName)\n\n      return [nodeName, replacement]\n    })\n  )\n}\n"],"mappings":";;;;;;AAAA;AAEA;AAOO,MAAMA,mBAAmB,gBAAGC,cAAK,CAACC,aAAa,CAAC,KAAK,CAAC;AAAA;AAEtD,SAASC,iCAAiC,CAC/CC,qBAAqB,EACrBC,sBAAsB,EACtB;EACA,SAASC,eAAe,GAAG;IACzB,IAAID,sBAAsB,EAAE;MAC1B;MACA;MACA,OAAO,IAAI;IACb;;IAEA;IACA;IACA;IACA;IACA;IACA,MAAME,uBAAuB,GAAGN,cAAK,CAACO,UAAU,CAACR,mBAAmB,CAAC;IAErE,OAAOO,uBAAuB;EAChC;EAEA,SAASE,0BAA0B,CAACC,OAAO,EAAE;IAC3C,MAAMC,kBAAkB,GAAGC,KAAK,IAAI;MAClC;MACA,MAAMC,YAAY,GAAGP,eAAe,EAAE;MACtC,IAAIO,YAAY,EAAE;QAChB,MAAMC,QAAQ,GAAG;UACf,GAAGF,KAAK;UACR,CAACG,+CAAoC,GAAGL;QAC1C,CAAC;QACD,OAAON,qBAAqB,CAAE,KAAI,EAAEU,QAAQ,CAAC;MAC/C,CAAC,MAAM;QACL,OAAOV,qBAAqB,CAACM,OAAO,EAAEE,KAAK,CAAC;MAC9C;IACF,CAAC;IACDD,kBAAkB,CAACK,WAAW,GAAI,uBAAsBN,OAAQ,EAAC;IACjE,OAAOC,kBAAkB;EAC3B;EAEA,SAASM,oBAAoB,CAACP,OAAO,EAAE;IACrC,MAAMC,kBAAkB,GAAGC,KAAK,IAAI;MAClC;MACA,MAAMC,YAAY,GAAGP,eAAe,EAAE;MACtC;MACA,IAAIO,YAAY,IAAI,EAAEK,mCAAwB,IAAIN,KAAK,CAAC,EAAE;QACxD,MAAMO,mBAAmB,GAAG;UAC1B,GAAGP,KAAK;UACR,CAACM,mCAAwB,GAAGE;QAC9B,CAAC;QACD,OAAOhB,qBAAqB,CAACM,OAAO,EAAES,mBAAmB,CAAC;MAC5D;MAEA,OAAOf,qBAAqB,CAACM,OAAO,EAAEE,KAAK,CAAC;IAC9C,CAAC;IACDD,kBAAkB,CAACK,WAAW,GAAI,uBAAsBN,OAAQ,EAAC;IACjE,OAAOC,kBAAkB;EAC3B;EAEA,OAAO,IAAIU,GAAG,CACZC,2BAAgB,CAACC,GAAG,CAACC,QAAQ,IAAI;IAC/B;IACA;IACA;IACA;IACA;;IAEA,MAAMC,WAAW,GACfD,QAAQ,KAAM,MAAK,IAAIA,QAAQ,KAAM,MAAK,GACtCf,0BAA0B,CAACe,QAAQ,CAAC,GACpCP,oBAAoB,CAACO,QAAQ,CAAC;IAEpC,OAAO,CAACA,QAAQ,EAAEC,WAAW,CAAC;EAChC,CAAC,CAAC,CACH;AACH"}